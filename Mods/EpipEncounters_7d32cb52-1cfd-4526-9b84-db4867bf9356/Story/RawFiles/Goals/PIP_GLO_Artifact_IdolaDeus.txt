Version 1
SubGoalCombiner SGC_AND
INITSECTION

DB_PIP_IdolaDeus_Element("Fire", "SurfaceFireBlessed");
DB_PIP_IdolaDeus_Element("Earth", "SurfaceOilBlessed");
DB_PIP_IdolaDeus_Element("Water", "SurfaceWaterBlessed");
DB_PIP_IdolaDeus_Element("Poison", "SurfacePoisonBlessed");

DB_PIP_IdolaDeus_ValidReactionElement("Fire");
DB_PIP_IdolaDeus_ValidReactionElement("Water");
DB_PIP_IdolaDeus_ValidReactionElement("Air");
DB_PIP_IdolaDeus_ValidReactionElement("Earth");

// reaction conditions.
DB_AMER_Reaction_ConditionTemplate("PIP_IdolaDeus", "CanSee");
DB_AMER_Reaction_ConditionTemplate("PIP_IdolaDeus", "LineOfSight");

// reactions SFX.
DB_AMER_Reaction_CastFX_Self("PIP_IdolaDeus", "RS3_FX_Items_Weapons_Cast_Weapon_Hand_01", "Dummy_L_HandFX");
DB_AMER_Reaction_CastFX_Self("PIP_IdolaDeus", "RS3_FX_Items_Weapons_Cast_Weapon_Hand_01", "Dummy_R_HandFX");
DB_AMER_Reaction_CastFX_Target("PIP_IdolaDeus", "PIP_FX_Artifact_IdolaDeus_Reaction", "");


// banter and text.
PROC_AMER_GEN_TSK_Add("EN", "AMER_Reactions_DisplayName_IdolaDeus", "Creation");
PROC_AMER_Reaction_AddBanter("PIP_IdolaDeus", "PIP_IdolaDeus_Banter_1");

KBSECTION

PROC PROC_AMER_Reaction_Fire(_Char, _Target, _x, _y, _z, "PIP_IdolaDeus", _RequestID, _IsRitual)
THEN
CreateExplosionAtPosition(_X, _Y, _Z, "Projectile_AMER_SCRIPT_SurfaceTransform_Bless", -1);

PROC PROC_AMER_Spells_SkillCast(_Char, _Skill, _InfusCount, _Type, _Element)
AND
DB_AMER_Artifacts_EquippedEffects(_ArtifactWielder, "Artifact_IdolaDeus", _)
AND
CharacterIsAlly(_Char, _ArtifactWielder, 1)
AND
QRY_AMER_GEN_OncePerRound_PerChar(_ArtifactWielder, "Artifact_IdolaDeus", _Char)
AND
DB_PIP_IdolaDeus_ValidReactionElement(_Element)
THEN
PROC_AMER_Reaction_Request(_ArtifactWielder, _Char, "PIP_IdolaDeus", "PIP_IdolaDeus", "skill_cast_target_voodoo_01_cast", 1);

PROC PROC_AMER_Combat_TurnStarted(_Char, _)
AND
DB_AMER_Artifacts_EquippedEffects(_Char, "Artifact_IdolaDeus", _)
// AND
// GetSurfaceGroundAt(_Char, _Surface)
AND
DB_PIP_IdolaDeus_Element(_Element, _Surface)
THEN
// CharacterStatusText(_Char, _Surface);
CharacterUnlockAbility(_Char, "Sourcery");

EXITSECTION

ENDEXITSECTION
ParentTargetEdge "AMER_GLO_Artifacts"